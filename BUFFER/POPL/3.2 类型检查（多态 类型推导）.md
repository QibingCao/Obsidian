---

类型: 笔记
创建日期: 2024-05-14
修改日期: 2024-05-14
---
## 类型检查
### 1 动机

强类型编译。
char ** p=...
(float*)p
c程序有强制类型转换，但是转换结果未定义。

  
Java强类型语言，不能将a直接强转为b，除非有继承关系。程序一旦编译通过不会有太大问题。
但c，cpp编译通过还是会有。

类型检查就是对抽象语法树的后序遍历。在遍历时实现语言的语法规则。

### task：
写一个算法，对程序是否满足类型规则做检测。

![[82134a422caea3885308f54fffe2c3fc.jpg]]
一个问题，树结构左边是变量定义，右边是语句。如何将左边的定义信息同步给右边呢。

  
采用符号表。
创建空表，插入符号-类型。
遍历左子树填表，在遍历右子树是查表。

#### 作用域

c语言中一个符号可以指代6个不同的东西。

作用域采用多级的符号表，例如树状的组织的各类哈希表。

## 类型推导

局部 var=x；
	必须有initiallizer，不能直接定义变量不赋值。

全局 
	整个类型可以在一个函数上或者类上不写。很难实现。

（x，y）-＞x，笛卡尔积。只要x，y类型相同，输出的类型也确定。

python普通函数直接就是这么用的，但是Java只能实现成一个泛型。
  
![[b3e69f220c840079f74b0dec7e5819bb.jpg]]
Java为什么不支持全局。

每个泛型函数都是一个命题，Java为了支持高阶泛型的特性。A<B＞

A B都是一个关于类型的函数而不是实例。

  
非直谓性，能用a实例化a吗。
所以无法写出全局类型推导。

HBJ说见虎书第14章

