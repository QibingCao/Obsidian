---

类型: 随想
创建日期: 2024-05-02
修改日期: 2024-05-02
---
函数调用栈指针EBP，ESP
1. **ESP (Stack Pointer, 栈指针)**: ESP 寄存器存储的是当前栈顶的地址。在函数调用时，ESP 用来指向栈中最后一个被推入的元素。每当在栈上压入新数据时（如调用函数时传递参数），ESP 的值会递减（因为栈在内存中通常是向下增长的）；每当从栈上弹出数据时（如函数返回后清理栈），ESP 的值则会递增。
2. **EBP (Base Pointer, 基指针)**: EBP 寄存器通常用于在函数调用期间作为一个参考点，来访问函数的参数和局部变量。**函数在调用开始时通常会把当前的 EBP 值压入栈中**，并将 ESP 的当前值赋给 EBP，这样不论 ESP 如何变化，函数内部通过 EBP 都可以稳定地访问到其参数和局部变量。这种方式被称为帧指针（Frame Pointer）技术。

当讨论到“保存的 EBP”时，通常是指在函数调用时发生的操作。在调用新函数前，当前函数的 EBP 值会被推入栈中，这是为了在函数返回时可以恢复这个 EBP 值，保证栈的结构不被破坏。这个保存的 EBP 值，也就是被调用函数的调用者的 EBP，存放在被调用函数的栈帧中，它是连接当前函数栈帧和上一个函数栈帧的关键链接。
这种机制使得函数调用链可以在返回时正确地恢复各个函数的栈环境，支持多层函数调用和返回的过程。
![[Pasted image 20240502163821.png]]

![[Pasted image 20240502162640.png]]

![[Pasted image 20240502163338.png]]